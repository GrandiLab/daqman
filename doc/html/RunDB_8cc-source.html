<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>daqman: analysis/src/RunDB.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_45112185e8b2b20582771867bff7ed01.html">analysis</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_0e1017bd2214db0b340afa834279e37e.html">src</a></div>
<h1>RunDB.cc</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="RunDB_8hh.html">RunDB.hh</a>"</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include "<a class="code" href="FitTH1F_8hh.html">FitTH1F.hh</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="utilities_8hh.html">utilities.hh</a>"</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#include "TH1F.h"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "TF1.h"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "TNamed.h"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "TGraph.h"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "TAxis.h"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "TPad.h"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="FitOverROI_8hh.html">FitOverROI.hh</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "TFitResult.h"</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;memory&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="classRunDB_1_1laserinfo.html#3e88ec37a7d4300e5be1569a194b4be8">00022</a> <a class="code" href="classRunDB_1_1laserinfo.html#01d924f40f14e58556e3075da1e2557f">RunDB::laserinfo::laserinfo</a>(<span class="keywordtype">int</span> Runid, <span class="keywordtype">int</span> Channel, time_t Runtime, <span class="keywordtype">int</span> Filters,
<a name="l00023"></a>00023                             <span class="keywordtype">double</span> Roi_start, <span class="keywordtype">double</span> Roi_end, <a class="code" href="classFitTH1F.html">FitTH1F</a>* h, std::string Fitsettings) : 
<a name="l00024"></a>00024   runid(Runid), channel(Channel), runtime(Runtime), filters(Filters),
<a name="l00025"></a>00025   roi_start(Roi_start), roi_end(Roi_end), inserttime(0), updatetime(0), fitsettings(Fitsettings) 
<a name="l00026"></a>00026 {
<a name="l00027"></a>00027         <span class="keyword">using namespace </span>FitOverROI;
<a name="l00028"></a>00028   <a class="code" href="classRunDB_1_1laserinfo.html#19bda38cc8defd401d126cfd905b394a">nbins</a> = h-&gt;GetNbinsX();
<a name="l00029"></a>00029   <a class="code" href="classRunDB_1_1laserinfo.html#84d51a06cbf82d4c69e1fff25901a7ef">xmin</a> = h-&gt;GetBinLowEdge(1);
<a name="l00030"></a>00030   <a class="code" href="classRunDB_1_1laserinfo.html#5077bbbdcbae4158bd1d98029aae090a">xmax</a> = h-&gt;GetBinLowEdge(<a class="code" href="classRunDB_1_1laserinfo.html#19bda38cc8defd401d126cfd905b394a">nbins</a>+1);
<a name="l00031"></a>00031   
<a name="l00032"></a>00032   
<a name="l00033"></a>00033   TF1* spefunc = h-&gt;GetFunction(<span class="stringliteral">"spefunc"</span>);
<a name="l00034"></a>00034         TFitResultPtr fitresult=h-&gt;<a class="code" href="classFitTH1F.html#d67bfb455b1c4686a138fcc46916763e">fitResult</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   <span class="keywordflow">if</span>(spefunc){
<a name="l00037"></a>00037     spefunc-&gt;GetRange(<a class="code" href="classRunDB_1_1laserinfo.html#565548edc25a58fdeb867b44c0df7508">fitmin</a>, <a class="code" href="classRunDB_1_1laserinfo.html#562c7d7ec3907d79fbf69d2708defca4">fitmax</a>);
<a name="l00038"></a>00038     <a class="code" href="classRunDB_1_1laserinfo.html#7c89b8538c606ab09303dafa742c8a87">entries</a> =(int) h-&gt;GetEntries();
<a name="l00039"></a>00039         <a class="code" href="classRunDB_1_1laserinfo.html#f69a60da599d09fec91b4ed1db6fedea">constant</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"CONSTANT"</span>);
<a name="l00040"></a>00040         <a class="code" href="classRunDB_1_1laserinfo.html#6944c3c76bcf9650c69f1403bcd0b2e0">lambda</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"LAMBDA"</span>);
<a name="l00041"></a>00041         <a class="code" href="classRunDB_1_1laserinfo.html#69b80078855eb1dcded37566a22cdb23">spe_mean</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"SPE_MEAN"</span>);
<a name="l00042"></a>00042         <a class="code" href="classRunDB_1_1laserinfo.html#ebde392f112f41b415cedc72b5f675ab">spe_sigma</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"SPE_SIGMA"</span>);
<a name="l00043"></a>00043         <a class="code" href="classRunDB_1_1laserinfo.html#c2450c4c2483279bde3b176bed441730">amp_E</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"AMP_E"</span>);
<a name="l00044"></a>00044         <a class="code" href="classRunDB_1_1laserinfo.html#51f3419fa145d4d55cdaacb70aef750e">p_E</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"P_E"</span>);
<a name="l00045"></a>00045         <a class="code" href="classRunDB_1_1laserinfo.html#efcf3382d36871153939564e17887861">shotnoise</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"SHOTNOISE"</span>);
<a name="l00046"></a>00046         <a class="code" href="classRunDB_1_1laserinfo.html#62badb45bbf1476175215dc993ee90c7">pedmean</a>= spefunc-&gt;GetParameter(<span class="stringliteral">"PEDMEAN"</span>);
<a name="l00047"></a>00047         
<a name="l00048"></a>00048     <a class="code" href="classRunDB_1_1laserinfo.html#53f11ab224ac9a5e42e02ee963ce6ebf">chi2</a> = spefunc-&gt;GetChisquare();
<a name="l00049"></a>00049     <a class="code" href="classRunDB_1_1laserinfo.html#cd7ee90bfa3bd4b1bbd8eccb22aae07d">ndf</a> = spefunc-&gt;GetNDF();
<a name="l00050"></a>00050         
<a name="l00051"></a>00051         <a class="code" href="classRunDB_1_1laserinfo.html#28bd01cfa705af27c13ca8304060d5c1">valley</a> = spefunc-&gt;GetMinimumX(0,<a class="code" href="classRunDB_1_1laserinfo.html#69b80078855eb1dcded37566a22cdb23">spe_mean</a>);
<a name="l00052"></a>00052   }
<a name="l00053"></a>00053   
<a name="l00054"></a>00054   <span class="keywordflow">if</span>(fitresult.Get()){
<a name="l00055"></a>00055         <a class="code" href="classRunDB_1_1laserinfo.html#ad801a4c4c228b86d40cb51b548b05b2">constant_err_low</a>= fitresult-&gt;LowerError(CONSTANT);
<a name="l00056"></a>00056         <a class="code" href="classRunDB_1_1laserinfo.html#7d813df44aa333ed87c1146f2ac5e309">lambda_err_low</a>= fitresult-&gt;LowerError(LAMBDA);
<a name="l00057"></a>00057         <a class="code" href="classRunDB_1_1laserinfo.html#4f5f37a96d382786b89aae90a244206b">spe_mean_err_low</a>= fitresult-&gt;LowerError(MEAN);
<a name="l00058"></a>00058         <a class="code" href="classRunDB_1_1laserinfo.html#a6aebc25a8f3bca90db887df19e892f3">spe_sigma_err_low</a>= fitresult-&gt;LowerError(SIGMA);
<a name="l00059"></a>00059         <a class="code" href="classRunDB_1_1laserinfo.html#b2e140f8bf98aa145761976dddce68c6">amp_E_err_low</a>= fitresult-&gt;LowerError(AMP_E);
<a name="l00060"></a>00060         <a class="code" href="classRunDB_1_1laserinfo.html#44e2b4b04f7fbb79665e916017ae2716">p_E_err_low</a>= fitresult-&gt;LowerError(P_E);
<a name="l00061"></a>00061         <a class="code" href="classRunDB_1_1laserinfo.html#a60ee5b75d13732f15540d385b3d7c0a">shotnoise_err_low</a>= fitresult-&gt;LowerError(SHOTNOISE);
<a name="l00062"></a>00062         <a class="code" href="classRunDB_1_1laserinfo.html#975d53c39db854fa34b91fe43985384d">pedmean_err_low</a>= fitresult-&gt;LowerError(PEDMEAN);
<a name="l00063"></a>00063   
<a name="l00064"></a>00064         <a class="code" href="classRunDB_1_1laserinfo.html#37c53deec69a20612acb806528fd067d">constant_err_high</a>= fitresult-&gt;UpperError(CONSTANT);
<a name="l00065"></a>00065         <a class="code" href="classRunDB_1_1laserinfo.html#a48b752e9ff402e8242e9a0ebb2146ab">lambda_err_high</a>= fitresult-&gt;UpperError(LAMBDA);
<a name="l00066"></a>00066         <a class="code" href="classRunDB_1_1laserinfo.html#20991dac8effbb564fc53ef43de472e4">spe_mean_err_high</a>= fitresult-&gt;UpperError(MEAN);
<a name="l00067"></a>00067         <a class="code" href="classRunDB_1_1laserinfo.html#bf9dc76833f77417d6c49b192a0136d2">spe_sigma_err_high</a>= fitresult-&gt;UpperError(SIGMA);
<a name="l00068"></a>00068         <a class="code" href="classRunDB_1_1laserinfo.html#73d87cd35e1b55691aa2d10d8c1fc63f">amp_E_err_high</a>= fitresult-&gt;UpperError(AMP_E);
<a name="l00069"></a>00069         <a class="code" href="classRunDB_1_1laserinfo.html#1a82c9f5e53e9e395de7350ff51f6bd7">p_E_err_high</a>= fitresult-&gt;UpperError(P_E);
<a name="l00070"></a>00070         <a class="code" href="classRunDB_1_1laserinfo.html#cf4d9b635dcdc8478a1d5ae408a35630">shotnoise_err_high</a>= fitresult-&gt;UpperError(SHOTNOISE);
<a name="l00071"></a>00071         <a class="code" href="classRunDB_1_1laserinfo.html#91d45963206fd7eff27e269b1d1f34c8">pedmean_err_high</a>= fitresult-&gt;UpperError(PEDMEAN);
<a name="l00072"></a>00072   
<a name="l00073"></a>00073         <span class="keyword">const</span> <span class="keywordtype">double</span>* params=fitresult-&gt;GetParams();
<a name="l00074"></a>00074         <a class="code" href="classRunDB_1_1laserinfo.html#12e99ec8c0c1acb960183d4b10b45369">pdfmean</a>= <a class="code" href="namespaceFitOverROI.html#cd8556cb95c7193b9f4a2f5dac107c44">FitOverROI::m_n</a>(params);
<a name="l00075"></a>00075         <a class="code" href="classRunDB_1_1laserinfo.html#4c8d4aef4d44a9204cca7207fa2ebffa">pdfmean_err</a>=<a class="code" href="namespaceFitOverROI.html#54551afce062ad457573f950974175dc">FitOverROI::pdfmean_error_corr</a>(fitresult);
<a name="l00076"></a>00076         <a class="code" href="classRunDB_1_1laserinfo.html#7f15829c99ced48f8a2dead3a231317c">pdfsigma</a>=<a class="code" href="namespaceFitOverROI.html#7146b6447b232829fe65c0c222d1a649">FitOverROI::sigma_n</a>(params);
<a name="l00077"></a>00077   }
<a name="l00078"></a>00078   <span class="keywordflow">else</span>{
<a name="l00079"></a>00079     
<a name="l00080"></a>00080     <a class="code" href="classMessage.html">Message</a>(ERROR)&lt;&lt;<span class="stringliteral">"Error: no fitresult found for channel "</span>&lt;&lt;Channel
<a name="l00081"></a>00081                   &lt;&lt;<span class="stringliteral">"."</span>&lt;&lt;std::endl
<a name="l00082"></a>00082                   &lt;&lt;<span class="stringliteral">"This bug should be fixed. If it's coming up, get in touch with Jason Brodsky, jaybrod@gmail.com"</span>&lt;&lt;std::endl;
<a name="l00083"></a>00083     <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">"no fitresultptr"</span>);
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087  
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="classRunDB_1_1runinfo.html#b99542879ea7ca7a136ab6d447a333ca">00089</a> <span class="keywordtype">void</span> <a class="code" href="classRunDB_1_1runinfo.html#b99542879ea7ca7a136ab6d447a333ca">RunDB::runinfo::Init</a>(<span class="keywordtype">bool</span> reset)
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091   <a class="code" href="classRunDB_1_1runinfo.html#4748936802ff8554b739e23c423e7e93">runid</a>=-1;
<a name="l00092"></a>00092   <a class="code" href="classRunDB_1_1runinfo.html#545fb454430279b166f1b7a2577184bc">starttime</a>=0;
<a name="l00093"></a>00093   <a class="code" href="classRunDB_1_1runinfo.html#3a4a5f5e187103cc6f16012614c593bb">endtime</a>=0;
<a name="l00094"></a>00094   <a class="code" href="classRunDB_1_1runinfo.html#cf9138328c91c241d44887cf88118ad0">events</a>=0;
<a name="l00095"></a>00095   <a class="code" href="classRunDB_1_1runinfo.html#b9f33eb0e1a4dd205af22b68f35bc392">livetime</a>=0;
<a name="l00096"></a>00096   <a class="code" href="classRunDB_1_1runinfo.html#6fa60dcab8680d639ad61a51ac02c080">type</a>=<span class="stringliteral">"regular"</span>;
<a name="l00097"></a>00097   <a class="code" href="classRunDB_1_1runinfo.html#364af771e8461c1ec69f16004e4e8d73">comment</a>=<span class="stringliteral">""</span>;
<a name="l00098"></a>00098   <a class="code" href="classRunDB_1_1runinfo.html#cf1f5b4c917bac78846620c869ee9f8a">drift_hv</a>=0;
<a name="l00099"></a>00099   <a class="code" href="classRunDB_1_1runinfo.html#85902e6d9256b7d76421832ad118fe38">extraction_hv</a>=0;
<a name="l00100"></a>00100   <a class="code" href="classRunDB_1_1runinfo.html#a1e26ac107c5f1f0719f2ef6ee623d36">trigger_veto</a> = -1;
<a name="l00101"></a>00101   <a class="code" href="classRunDB_1_1runinfo.html#08982bcd08358c88436afc46e11082ac">pre_trigger_time_us</a> = -1;
<a name="l00102"></a>00102   <a class="code" href="classRunDB_1_1runinfo.html#5d87193f4dbc77a18dc5a481302219ca">post_trigger_time_us</a> = -1;
<a name="l00103"></a>00103   <a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.clear();
<a name="l00104"></a>00104   <span class="keywordflow">if</span>(!reset)
<a name="l00105"></a>00105     <a class="code" href="classRunDB_1_1runinfo.html#d7c5b77c698b0287fd8c29760c44de20">InitializeParameterList</a>();
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00108"></a><a class="code" href="classRunDB_1_1runinfo.html#d7c5b77c698b0287fd8c29760c44de20">00108</a> <span class="keywordtype">void</span> <a class="code" href="classRunDB_1_1runinfo.html#d7c5b77c698b0287fd8c29760c44de20">RunDB::runinfo::InitializeParameterList</a>()
<a name="l00109"></a>00109 {
<a name="l00110"></a>00110   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"runid"</span>, <a class="code" href="classRunDB_1_1runinfo.html#4748936802ff8554b739e23c423e7e93">runid</a>, <span class="stringliteral">"unique ID number for the run"</span>);
<a name="l00111"></a>00111   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"starttime"</span>,<a class="code" href="classRunDB_1_1runinfo.html#545fb454430279b166f1b7a2577184bc">starttime</a>,<span class="stringliteral">"Timestamp at start of run"</span>);
<a name="l00112"></a>00112   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"endtime"</span>,<a class="code" href="classRunDB_1_1runinfo.html#3a4a5f5e187103cc6f16012614c593bb">endtime</a>, <span class="stringliteral">"Timestamp at end of run"</span>);
<a name="l00113"></a>00113   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"events"</span>, <a class="code" href="classRunDB_1_1runinfo.html#cf9138328c91c241d44887cf88118ad0">events</a>, <span class="stringliteral">"Number of events recorded during run"</span>);
<a name="l00114"></a>00114   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"livetime"</span>, <a class="code" href="classRunDB_1_1runinfo.html#b9f33eb0e1a4dd205af22b68f35bc392">livetime</a>, 
<a name="l00115"></a>00115                     <span class="stringliteral">"Runtime scaled for number of accepted triggers"</span>);
<a name="l00116"></a>00116   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"type"</span>, <a class="code" href="classRunDB_1_1runinfo.html#6fa60dcab8680d639ad61a51ac02c080">type</a>, <span class="stringliteral">"Label giving purpose of run"</span>);
<a name="l00117"></a>00117   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"comment"</span>,<a class="code" href="classRunDB_1_1runinfo.html#364af771e8461c1ec69f16004e4e8d73">comment</a>,<span class="stringliteral">"Generic information about run"</span>);
<a name="l00118"></a>00118   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"drift_hv"</span>,<a class="code" href="classRunDB_1_1runinfo.html#cf1f5b4c917bac78846620c869ee9f8a">drift_hv</a>,<span class="stringliteral">"Setting of drift_hv field"</span>);
<a name="l00119"></a>00119   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"extraction_hv"</span>,<a class="code" href="classRunDB_1_1runinfo.html#85902e6d9256b7d76421832ad118fe38">extraction_hv</a>,<span class="stringliteral">"Extraction field setting"</span>);
<a name="l00120"></a>00120   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"trigger_veto"</span>,<a class="code" href="classRunDB_1_1runinfo.html#a1e26ac107c5f1f0719f2ef6ee623d36">trigger_veto</a>,
<a name="l00121"></a>00121                     <span class="stringliteral">"Length of per-trigger veto in ms; -1 to disable"</span>);
<a name="l00122"></a>00122   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"pre_trigger_time_us"</span>,<a class="code" href="classRunDB_1_1runinfo.html#08982bcd08358c88436afc46e11082ac">pre_trigger_time_us</a>,
<a name="l00123"></a>00123                     <span class="stringliteral">"Length of pre-trigger digitization window in us"</span>);
<a name="l00124"></a>00124   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"post_trigger_time_us"</span>,<a class="code" href="classRunDB_1_1runinfo.html#5d87193f4dbc77a18dc5a481302219ca">post_trigger_time_us</a>,
<a name="l00125"></a>00125                     <span class="stringliteral">"Length of post-trigger digitization window in us"</span>);
<a name="l00126"></a>00126   
<a name="l00127"></a>00127   <a class="code" href="classParameterList.html#e5bf39e62a28e49b681674b5921c3353">RegisterFunction</a>(<a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#dfed406ac44fe62b2bfdd29852ddfb7d">channel_inserter::GetFunctionName</a>(),
<a name="l00128"></a>00128                    <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html">channel_inserter</a>(<span class="keyword">this</span>), <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html">channel_inserter</a>(<span class="keyword">this</span>),
<a name="l00129"></a>00129                    <span class="stringliteral">"Insert a daq channel's info into the database"</span>);
<a name="l00130"></a>00130   <a class="code" href="classParameterList.html#1b8c5e9f442b45ea87cde1ac7674d47c">RegisterReadFunction</a>(<a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html#1ebcf356be3558f244150de7c2853f16">channel_clearer::GetFunctionName</a>(),
<a name="l00131"></a>00131                        <a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html">channel_clearer</a>(<span class="keyword">this</span>),
<a name="l00132"></a>00132                        <span class="stringliteral">"Clear the list of channel info"</span>);
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#d88f4f3ca30b7d2a0e1e6a68b8dd34a9">00135</a> <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#d88f4f3ca30b7d2a0e1e6a68b8dd34a9">RunDB::runinfo::channelinfo::channelinfo</a>() : 
<a name="l00136"></a>00136   <a class="code" href="classParameterList.html">ParameterList</a>(<span class="stringliteral">"channelinfo"</span>,<span class="stringliteral">"Information about the state of a daq channel for database insertion"</span>), 
<a name="l00137"></a>00137   channel(-1) , voltage(0), amplification(1), spe_mean(1), spe_sigma(0), calibration_run(-1),
<a name="l00138"></a>00138   calibration_channel(-1), cal_filters(2), reload_cal(true), 
<a name="l00139"></a>00139   reload_cal_run(true)
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141   <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#fef3cb3ddca2998ff13a66a7b354a780">InitializeParameterList</a>();
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#fef3cb3ddca2998ff13a66a7b354a780">00145</a> <span class="keywordtype">void</span> <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#fef3cb3ddca2998ff13a66a7b354a780">RunDB::runinfo::channelinfo::InitializeParameterList</a>()
<a name="l00146"></a>00146 {
<a name="l00147"></a>00147   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"channel"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#0439406d9fe3e4b0599fb2ba8e8df651">channel</a>, <span class="stringliteral">"Unique ID number"</span>);
<a name="l00148"></a>00148   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"voltage"</span>,<a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#49c2f375965571f33e93c21bc566f702">voltage</a>, <span class="stringliteral">"High Voltage applied to PMT"</span>);
<a name="l00149"></a>00149   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"amplification"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#e57f226a18c939470eee61aa95c6ad69">amplification</a>, 
<a name="l00150"></a>00150                     <span class="stringliteral">"Amplification applied to channel after PMT output"</span>);
<a name="l00151"></a>00151   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"spe_mean"</span>,<a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#7b727e2ee44a2883cbd9e9d46b8a1238">spe_mean</a>,
<a name="l00152"></a>00152                     <span class="stringliteral">"Single photoelectron mean from calibration database"</span>);
<a name="l00153"></a>00153   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"spe_sigma"</span>,<a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#1c23b590f9974d9e20bcb31f58938145">spe_sigma</a>,
<a name="l00154"></a>00154                     <span class="stringliteral">"Single photoelectron sigma from calibration database"</span>);
<a name="l00155"></a>00155   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"calibration_run"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#b71fa6750bb19683a1dbdaa73af92c21">calibration_run</a>,
<a name="l00156"></a>00156                     <span class="stringliteral">"Run from which calibration data was loaded"</span>);
<a name="l00157"></a>00157   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"calibration_channel"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#5602f0c8178ddd59439dc90d9d6cb55e">calibration_channel</a>,
<a name="l00158"></a>00158                     <span class="stringliteral">"Channel which should be used for calibration data"</span>);
<a name="l00159"></a>00159   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"cal_filters"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#7c01216971169d7a409ecfba112e1bfe">cal_filters</a>,
<a name="l00160"></a>00160                     <span class="stringliteral">"Only consider runs with x filters for calibration"</span>);
<a name="l00161"></a>00161   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"reload_cal"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#aed2b9cca03061aa10342446911968ce">reload_cal</a>,
<a name="l00162"></a>00162                     <span class="stringliteral">"Search for calibration info in DB rather than saved vals"</span>);
<a name="l00163"></a>00163   <a class="code" href="classParameterList.html#3db08300f6dfab45123dd4e2db712d89">RegisterParameter</a>(<span class="stringliteral">"reload_cal_run"</span>, <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#ae0f0bf5822a735a6f7a15f173327373">reload_cal_run</a>,
<a name="l00164"></a>00164                     <span class="stringliteral">"Search for new calibration run rather than previous one"</span>);
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="classRunDB_1_1runinfo.html#02268cd17b74ae7d21958ecd03eaaff4">00168</a> <span class="keywordtype">bool</span> <a class="code" href="classRunDB_1_1runinfo.html#02268cd17b74ae7d21958ecd03eaaff4">RunDB::runinfo::InsertIntoDatabase</a>()
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170   <span class="keywordtype">bool</span> success = <span class="keyword">false</span>;
<a name="l00171"></a>00171   <span class="keywordflow">return</span> success;
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="RunDB_8hh.html#38043c54d556cbbe3daa3372c2a04acf">00174</a> std::istream &amp; operator&gt;&gt; (std::istream &amp; in, <a class="code" href="structRunDB_1_1runinfo_1_1runtype.html">RunDB::runinfo::runtype</a> &amp; type)
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176   std::string temp = <span class="stringliteral">""</span>;
<a name="l00177"></a>00177   in &gt;&gt; temp;
<a name="l00178"></a>00178   type.assign (temp);
<a name="l00179"></a>00179   <span class="keywordflow">return</span> in;
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="keyword">const</span> std::string&amp; runinfokey=<span class="stringliteral">"runinfo"</span>;
<a name="l00183"></a>00183 <span class="keyword">const</span> std::string&amp; runinfohelp=<span class="stringliteral">"Information about daq runs for database"</span>;
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="classRunDB_1_1runinfo.html#94582ecb964367442151251cad637e81">00185</a> <a class="code" href="classRunDB_1_1runinfo.html#94582ecb964367442151251cad637e81">RunDB::runinfo::runinfo</a>() : <a class="code" href="classParameterList.html">ParameterList</a>(runinfokey, runinfohelp)
<a name="l00186"></a>00186 {
<a name="l00187"></a>00187   <a class="code" href="classRunDB_1_1runinfo.html#b99542879ea7ca7a136ab6d447a333ca">Init</a>();
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   
<a name="l00191"></a><a class="code" href="classRunDB_1_1runinfo.html#161e434f1b65b4a6ff252b1d092c8d3b">00191</a> <span class="keywordtype">bool</span> <a class="code" href="classRunDB_1_1runinfo.html#161e434f1b65b4a6ff252b1d092c8d3b">RunDB::runinfo::SyncWithDatabase</a>()
<a name="l00192"></a>00192 {
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <a class="code" href="classMessage.html">Message</a>(ERROR)&lt;&lt;<span class="stringliteral">"Attempt to sync with database, but mysql access disabled.\n"</span>;
<a name="l00195"></a>00195   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html#c7f66e9046edeb52d4f6e6a4d82df472">00198</a> std::istream&amp; <a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html#c7f66e9046edeb52d4f6e6a4d82df472">RunDB::runinfo::channel_clearer::operator()</a>(std::istream&amp; in)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200   <a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html#d45314d111dbc517d144b5e9e6d06413">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.clear();
<a name="l00201"></a>00201   <span class="keywordflow">return</span> in;
<a name="l00202"></a>00202 }  
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#a97713328ffb20020cd8fd7dacccfc7c">00204</a> std::istream&amp; <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#a97713328ffb20020cd8fd7dacccfc7c">RunDB::runinfo::channel_inserter::operator()</a>(std::istream&amp; in){
<a name="l00205"></a>00205   <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html">channelinfo</a> info;
<a name="l00206"></a>00206   in&gt;&gt;info;
<a name="l00207"></a>00207   <span class="comment">//make sure it isn't there already</span>
<a name="l00208"></a>00208   <span class="keywordflow">for</span>(size_t i=0; i &lt; <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.size(); i++){
<a name="l00209"></a>00209     <span class="keywordflow">if</span>(<a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>[i].channel == info.channel){
<a name="l00210"></a>00210       <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>[i] = info;
<a name="l00211"></a>00211       <span class="keywordflow">return</span> in;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213   }
<a name="l00214"></a>00214   <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.push_back(info);
<a name="l00215"></a>00215   <span class="keywordflow">return</span> in;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#5f3e8a8c335787b9c116c2935839665b">00218</a> std::ostream&amp; <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#a97713328ffb20020cd8fd7dacccfc7c">RunDB::runinfo::channel_inserter::operator()</a>(std::ostream&amp; out){
<a name="l00219"></a>00219   out&lt;&lt;<span class="stringliteral">"\n"</span>&lt;&lt;<a class="code" href="classRunDB_1_1runinfo_1_1channel__clearer.html#1ebcf356be3558f244150de7c2853f16">channel_clearer::GetFunctionName</a>()&lt;&lt;<span class="stringliteral">" ,\n"</span>;
<a name="l00220"></a>00220   <span class="keywordflow">for</span>(size_t i=0; i &lt; <a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.size(); i++){
<a name="l00221"></a>00221     out&lt;&lt;<a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#dfed406ac44fe62b2bfdd29852ddfb7d">GetFunctionName</a>()&lt;&lt;<span class="stringliteral">" "</span>&lt;&lt;<a class="code" href="classRunDB_1_1runinfo_1_1channel__inserter.html#7f095f0dc36e837c349527c59225af5d">_parent</a>-&gt;<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.at(i)&lt;&lt;<span class="stringliteral">" "</span>;
<a name="l00222"></a>00222   }
<a name="l00223"></a>00223   <span class="keywordflow">return</span> out;
<a name="l00224"></a>00224 }  
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="namespaceRunDB.html#ae41768f06d8ff7728278c0f469401a2">00227</a> <span class="keywordtype">int</span> <a class="code" href="namespaceRunDB.html#ae41768f06d8ff7728278c0f469401a2">RunDB::InsertLaserInfo</a>(<span class="keyword">const</span> std::vector&lt;RunDB::laserinfo&gt;&amp; info)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229   <span class="keywordtype">int</span> lines=0;
<a name="l00230"></a>00230   <span class="keywordflow">return</span> lines;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="namespaceRunDB.html#37de8924138880c4bf63ef3006c11349">00233</a> <span class="keywordtype">int</span> <a class="code" href="namespaceRunDB.html#ae41768f06d8ff7728278c0f469401a2">RunDB::InsertLaserInfo</a>(<span class="keyword">const</span> <a class="code" href="classRunDB_1_1laserinfo.html">RunDB::laserinfo</a>&amp; info)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   std::vector&lt;RunDB::laserinfo&gt; vec;
<a name="l00236"></a>00236   vec.push_back(info);
<a name="l00237"></a>00237   <span class="keywordflow">return</span> <a class="code" href="namespaceRunDB.html#ae41768f06d8ff7728278c0f469401a2">RunDB::InsertLaserInfo</a>(vec);
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="namespaceRunDB.html#a99b851eb46832ac94ea941d335f219d">00240</a> <span class="keywordtype">int</span> <a class="code" href="namespaceRunDB.html#a99b851eb46832ac94ea941d335f219d">RunDB::InsertSpeInfo</a>(<span class="keyword">const</span> std::vector&lt;RunDB::speinfo&gt; &amp;info){
<a name="l00241"></a>00241   <span class="keywordtype">int</span> lines=0;
<a name="l00242"></a>00242   <span class="keywordflow">return</span> lines;
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="group__daqroot.html#ge2b7cd9c0aca3d9c409f2181bc413fe8">00245</a> <span class="keywordtype">double</span> <a class="code" href="group__daqroot.html#ge2b7cd9c0aca3d9c409f2181bc413fe8">GetSPEScaleFactor</a>(<span class="keywordtype">int</span> run, <span class="keywordtype">int</span> channel, <span class="keywordtype">int</span> filters, <span class="keywordtype">bool</span> isMC)
<a name="l00246"></a>00246 {
<a name="l00247"></a>00247   <span class="keyword">const</span> <span class="keywordtype">double</span> failure = 0;
<a name="l00248"></a>00248   <span class="keywordflow">return</span> failure;
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="group__daqroot.html#g57200408ef669a0feffa329e24e252b7">00251</a> TGraph* <a class="code" href="group__daqroot.html#g57200408ef669a0feffa329e24e252b7">PlotDatabaseVars</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* varx, <span class="keyword">const</span> <span class="keywordtype">char</span>* vary, <span class="keyword">const</span> <span class="keywordtype">char</span>* table,
<a name="l00252"></a>00252                          <span class="keyword">const</span> <span class="keywordtype">char</span>* cut)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <a class="code" href="classMessage.html">Message</a>(ERROR)&lt;&lt;<span class="stringliteral">"Database access disabled!\n"</span>;
<a name="l00256"></a>00256   <span class="keywordflow">return</span> 0;
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00260"></a><a class="code" href="RunDB_8hh.html#fa275a71784815c2ded53e8306404c8c">00260</a> std::istream&amp; <a class="code" href="RunDB_8hh.html#38043c54d556cbbe3daa3372c2a04acf">operator&gt;&gt;</a>(std::istream&amp; in, <a class="code" href="structRunDB_1_1runinfo_1_1time__param.html">RunDB::runinfo::time_param</a>&amp; t)
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262   std::string dummy;
<a name="l00263"></a>00263   in&gt;&gt;dummy;
<a name="l00264"></a>00264   <span class="keywordflow">if</span>(dummy[4] == <span class="charliteral">'-'</span>){
<a name="l00265"></a>00265     <span class="comment">//this is a string</span>
<a name="l00266"></a>00266     <span class="keywordtype">int</span> year, month, day;
<a name="l00267"></a>00267     sscanf(dummy.c_str(),<span class="stringliteral">"%4d-%2d-%2d"</span>,&amp;year, &amp;month, &amp;day);
<a name="l00268"></a>00268     in&gt;&gt;dummy;
<a name="l00269"></a>00269     <span class="keywordtype">int</span> hours, minutes, seconds;
<a name="l00270"></a>00270     sscanf(dummy.c_str(),<span class="stringliteral">"%2d:%2d:%2d"</span>, &amp;hours, &amp;minutes, &amp;seconds);
<a name="l00271"></a>00271     <span class="keyword">struct </span>tm timeinfo;
<a name="l00272"></a>00272     timeinfo.tm_sec = seconds;
<a name="l00273"></a>00273     timeinfo.tm_min = minutes;
<a name="l00274"></a>00274     timeinfo.tm_hour = hours;
<a name="l00275"></a>00275     timeinfo.tm_mday = day;
<a name="l00276"></a>00276     timeinfo.tm_mon = month-1;
<a name="l00277"></a>00277     timeinfo.tm_year = year-1900;
<a name="l00278"></a>00278     timeinfo.tm_isdst=-1;
<a name="l00279"></a>00279         
<a name="l00280"></a>00280     t.<a class="code" href="structRunDB_1_1runinfo_1_1time__param.html#50d46591be9ab634d2acfa8040dd18d9">t</a> = timegm(&amp;timeinfo);
<a name="l00281"></a>00281     <span class="keywordflow">return</span> in;
<a name="l00282"></a>00282   }
<a name="l00283"></a>00283   <span class="comment">//if we get here, it should be an integer</span>
<a name="l00284"></a>00284   t.<a class="code" href="structRunDB_1_1runinfo_1_1time__param.html#50d46591be9ab634d2acfa8040dd18d9">t</a> = atoi(dummy.c_str());
<a name="l00285"></a>00285   <span class="keywordflow">return</span> in;
<a name="l00286"></a>00286 }
<a name="l00288"></a><a class="code" href="RunDB_8hh.html#d534078c9373af93d221261ccfa45287">00288</a> std::ostream&amp; <a class="code" href="RunDB_8hh.html#d534078c9373af93d221261ccfa45287">operator&lt;&lt;</a>(std::ostream&amp; out,<a class="code" href="structRunDB_1_1runinfo_1_1time__param.html">RunDB::runinfo::time_param</a>&amp; t)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290   <span class="keywordtype">char</span> str[20];
<a name="l00291"></a>00291   std::strftime(str,20,<span class="stringliteral">"%Y-%m-%d %H:%M:%S"</span>,std::gmtime(&amp;t.<a class="code" href="structRunDB_1_1runinfo_1_1time__param.html#50d46591be9ab634d2acfa8040dd18d9">t</a>));
<a name="l00292"></a>00292   out&lt;&lt;str;
<a name="l00293"></a>00293   <span class="keywordflow">return</span> out;
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="comment">/*</span>
<a name="l00298"></a>00298 <span class="comment">Command used to create laser table:</span>
<a name="l00299"></a>00299 <span class="comment"></span>
<a name="l00300"></a>00300 <span class="comment">CREATE TABLE `testlaser` (</span>
<a name="l00301"></a>00301 <span class="comment">  `runid` int(11) NOT NULL,</span>
<a name="l00302"></a>00302 <span class="comment">  `channel` int(11) NOT NULL,</span>
<a name="l00303"></a>00303 <span class="comment">  `runtime` datetime NOT NULL,</span>
<a name="l00304"></a>00304 <span class="comment">  `filters` int(11) DEFAULT NULL,</span>
<a name="l00305"></a>00305 <span class="comment">  `roi_start` double DEFAULT NULL,</span>
<a name="l00306"></a>00306 <span class="comment">  `roi_end` double DEFAULT NULL,</span>
<a name="l00307"></a>00307 <span class="comment">  `nbins` int(11) DEFAULT NULL,</span>
<a name="l00308"></a>00308 <span class="comment">  `xmin` double DEFAULT NULL,</span>
<a name="l00309"></a>00309 <span class="comment">  `xmax` double DEFAULT NULL,</span>
<a name="l00310"></a>00310 <span class="comment">  `fitmin` double DEFAULT NULL,</span>
<a name="l00311"></a>00311 <span class="comment">  `fitmax` double DEFAULT NULL,</span>
<a name="l00312"></a>00312 <span class="comment">  `fitsettings` text DEFAULT NULL,</span>
<a name="l00313"></a>00313 <span class="comment">  `entries` int(11) DEFAULT NULL,</span>
<a name="l00314"></a>00314 <span class="comment">  `constant` double DEFAULT NULL,</span>
<a name="l00315"></a>00315 <span class="comment">  `lambda` double DEFAULT NULL,</span>
<a name="l00316"></a>00316 <span class="comment">  `spe_mean` double DEFAULT NULL,</span>
<a name="l00317"></a>00317 <span class="comment">  `spe_sigma` double DEFAULT NULL,</span>
<a name="l00318"></a>00318 <span class="comment">  `amp_E` double DEFAULT NULL,</span>
<a name="l00319"></a>00319 <span class="comment">  `p_E` double DEFAULT NULL,</span>
<a name="l00320"></a>00320 <span class="comment">  `shotnoise` double DEFAULT NULL,</span>
<a name="l00321"></a>00321 <span class="comment">  `pedmean` double DEFAULT NULL,</span>
<a name="l00322"></a>00322 <span class="comment">  `constant_err_low` double DEFAULT NULL,</span>
<a name="l00323"></a>00323 <span class="comment">  `lambda_err_low` double DEFAULT NULL,</span>
<a name="l00324"></a>00324 <span class="comment">  `spe_mean_err_low` double DEFAULT NULL,</span>
<a name="l00325"></a>00325 <span class="comment">  `spe_sigma_err_low` double DEFAULT NULL,</span>
<a name="l00326"></a>00326 <span class="comment">  `amp_E_err_low` double DEFAULT NULL,</span>
<a name="l00327"></a>00327 <span class="comment">  `p_E_err_low` double DEFAULT NULL,</span>
<a name="l00328"></a>00328 <span class="comment">  `shotnoise_err_low` double DEFAULT NULL,</span>
<a name="l00329"></a>00329 <span class="comment">  `pedmean_err_low` double DEFAULT NULL,</span>
<a name="l00330"></a>00330 <span class="comment">  `constant_err_high` double DEFAULT NULL,</span>
<a name="l00331"></a>00331 <span class="comment">  `lambda_err_high` double DEFAULT NULL,</span>
<a name="l00332"></a>00332 <span class="comment">  `spe_mean_err_high` double DEFAULT NULL,</span>
<a name="l00333"></a>00333 <span class="comment">  `spe_sigma_err_high` double DEFAULT NULL,</span>
<a name="l00334"></a>00334 <span class="comment">  `amp_E_err_high` double DEFAULT NULL,</span>
<a name="l00335"></a>00335 <span class="comment">  `p_E_err_high` double DEFAULT NULL,</span>
<a name="l00336"></a>00336 <span class="comment">  `shotnoise_err_high` double DEFAULT NULL,</span>
<a name="l00337"></a>00337 <span class="comment">  `pedmean_err_high` double DEFAULT NULL,</span>
<a name="l00338"></a>00338 <span class="comment">    `pdfmean` double DEFAULT NULL,</span>
<a name="l00339"></a>00339 <span class="comment">        `pdfmean_err` double DEFAULT NULL,</span>
<a name="l00340"></a>00340 <span class="comment">        `pdfsigma` double DEFAULT NULL,</span>
<a name="l00341"></a>00341 <span class="comment">  `chi2` double DEFAULT NULL,</span>
<a name="l00342"></a>00342 <span class="comment">  `ndf` int(11) DEFAULT NULL,</span>
<a name="l00343"></a>00343 <span class="comment">  `inserttime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',</span>
<a name="l00344"></a>00344 <span class="comment">  `updatetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</span>
<a name="l00345"></a>00345 <span class="comment">) ENGINE=MyISAM DEFAULT CHARSET=latin1;</span>
<a name="l00346"></a>00346 <span class="comment">*/</span>
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#31e8f92c666e230bdf9827d0e858de17">00349</a> <span class="keywordtype">bool</span> <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#31e8f92c666e230bdf9827d0e858de17">RunDB::runinfo::channelinfo::LoadCalibrationInfo</a>(<a class="code" href="structRunDB_1_1runinfo_1_1time__param.html">time_param</a> runtime,
<a name="l00350"></a>00350                                                       <span class="keywordtype">bool</span> isMC)
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352   <span class="comment">//if we get here, there is no run with matching voltage</span>
<a name="l00353"></a>00353   <a class="code" href="classMessage.html">Message</a>(DEBUG)&lt;&lt;<span class="stringliteral">"Unable to load calibration info for channel "</span>&lt;&lt;<a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html#0439406d9fe3e4b0599fb2ba8e8df651">channel</a>
<a name="l00354"></a>00354                   &lt;&lt;<span class="stringliteral">"\n"</span>;
<a name="l00355"></a>00355   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00356"></a>00356 }
<a name="l00357"></a>00357 
<a name="l00358"></a><a class="code" href="classRunDB_1_1runinfo.html#f63c7ab38816983d18c2641265b52015">00358</a> <span class="keywordtype">int</span> <a class="code" href="classRunDB_1_1runinfo.html#f63c7ab38816983d18c2641265b52015">RunDB::runinfo::LoadCalibrationInfo</a>()
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360   
<a name="l00361"></a>00361   <span class="keywordflow">if</span>(<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.size() == 0){
<a name="l00362"></a>00362     <a class="code" href="classMessage.html">Message</a>(WARNING)&lt;&lt;<span class="stringliteral">"Attempted to load calibration without any channels!\n"</span>;
<a name="l00363"></a>00363     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00364"></a>00364   }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   <a class="code" href="classMessage.html">Message</a>(ERROR)&lt;&lt;<span class="stringliteral">"Attemptted to load calibration without database support!\n"</span>;
<a name="l00367"></a>00367   <span class="keywordflow">return</span> 0;
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a><a class="code" href="classRunDB_1_1runinfo.html#356d55ed79b97f3e7ea7ccd18c922c67">00370</a> <a class="code" href="classRunDB_1_1runinfo_1_1channelinfo.html">RunDB::runinfo::channelinfo</a>* <a class="code" href="classRunDB_1_1runinfo.html#356d55ed79b97f3e7ea7ccd18c922c67">RunDB::runinfo::GetChannelInfo</a>(<span class="keywordtype">int</span> channel)
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372   std::vector&lt;channelinfo&gt;::iterator ch = 
<a name="l00373"></a>00373     std::find(<a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.begin(), <a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.end(), channel);
<a name="l00374"></a>00374   <span class="keywordflow">if</span>(ch != <a class="code" href="classRunDB_1_1runinfo.html#28a43ec7e638ad2873ad36afc33a562f">channels</a>.end())
<a name="l00375"></a>00375     <span class="keywordflow">return</span> &amp;(*ch);
<a name="l00376"></a>00376   <span class="keywordflow">return</span> 0;
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="classRunDB_1_1runinfo.html#8d188fc84523e0837c4512319f76da4d">00379</a> <span class="keywordtype">void</span> <a class="code" href="classRunDB_1_1runinfo.html#8d188fc84523e0837c4512319f76da4d">RunDB::runinfo::ResetRunStats</a>()
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381   <a class="code" href="classRunDB_1_1runinfo.html#545fb454430279b166f1b7a2577184bc">starttime</a> = 0;
<a name="l00382"></a>00382   <a class="code" href="classRunDB_1_1runinfo.html#3a4a5f5e187103cc6f16012614c593bb">endtime</a> = 0;
<a name="l00383"></a>00383   <a class="code" href="classRunDB_1_1runinfo.html#cf9138328c91c241d44887cf88118ad0">events</a> = 0;
<a name="l00384"></a>00384   <a class="code" href="classRunDB_1_1runinfo.html#b9f33eb0e1a4dd205af22b68f35bc392">livetime</a> = 0;
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="namespaceRunDB.html#6e88c9537da9875aeb97d8864079a928">00388</a> <span class="keywordtype">int</span> <a class="code" href="namespaceRunDB.html#27f968f83ba52986070052bae3f5b5eb">RunDB::GetRunNearDate</a>(<span class="keyword">const</span> std::string&amp; datestr,  <span class="keywordtype">bool</span> isMC)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <span class="keywordflow">return</span> -1;
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393  
<a name="l00394"></a><a class="code" href="classRunDB_1_1campaigninfo.html#55a6183b84056ea9154d772afc5c11b5">00394</a> <a class="code" href="classRunDB_1_1campaigninfo.html#55a6183b84056ea9154d772afc5c11b5">RunDB::campaigninfo::campaigninfo</a>()
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396   <a class="code" href="classRunDB_1_1campaigninfo.html#f94bdc5c47921e3081af1d50cd4f5474">Init</a>();
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="classRunDB_1_1campaigninfo.html#b7223ffc76d102ac764937b7afb047a3">00399</a> <span class="keywordtype">int</span> <a class="code" href="classRunDB_1_1campaigninfo.html#b7223ffc76d102ac764937b7afb047a3">RunDB::campaigninfo::LoadCampaignInfo</a>(time_t run_start_time) 
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <a class="code" href="classRunDB_1_1campaigninfo.html#f94bdc5c47921e3081af1d50cd4f5474">Init</a>();
<a name="l00402"></a>00402     
<a name="l00403"></a>00403     <a class="code" href="classMessage.html">Message</a>(ERROR)&lt;&lt;<span class="stringliteral">"RunDB::campaigninfo::LoadCampaignInfo"</span>&lt;&lt;std::endl
<a name="l00404"></a>00404                   &lt;&lt;<span class="stringliteral">"Unable to load campaign info"</span>&lt;&lt;std::endl;
<a name="l00405"></a>00405     <span class="keywordflow">return</span> 0;
<a name="l00406"></a>00406     
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#98ec6781cb085c13d1720d35daa1f919">00409</a> <span class="keywordtype">bool</span> <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#98ec6781cb085c13d1720d35daa1f919">RunDB::campaigninfo::pmtinfo::LoadCampaignInfo</a>(<span class="keywordtype">long</span> campaign_id, <span class="keywordtype">long</span> version_id, <span class="keywordtype">int</span> channel)
<a name="l00410"></a>00410 {
<a name="l00411"></a>00411     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a><a class="code" href="classRunDB_1_1campaigninfo.html#c56b177e0f83d712a62a5ebe01fb669a">00414</a> <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html">RunDB::campaigninfo::pmtinfo</a>* <a class="code" href="classRunDB_1_1campaigninfo.html#c56b177e0f83d712a62a5ebe01fb669a">RunDB::campaigninfo::GetPMTInfo</a>(<span class="keywordtype">int</span> channel)
<a name="l00415"></a>00415 {
<a name="l00416"></a>00416     std::map&lt;int, RunDB::campaigninfo::pmtinfo&gt;::iterator p = <a class="code" href="classRunDB_1_1campaigninfo.html#e9bea68fb66903a2ac49a81307e59255">pmts</a>.find(channel);
<a name="l00417"></a>00417     <span class="keywordflow">if</span>(p != <a class="code" href="classRunDB_1_1campaigninfo.html#e9bea68fb66903a2ac49a81307e59255">pmts</a>.end())
<a name="l00418"></a>00418         <span class="keywordflow">return</span> &amp;(p-&gt;second);
<a name="l00419"></a>00419     <span class="keywordflow">else</span>
<a name="l00420"></a>00420         <span class="keywordflow">return</span> 0;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a><a class="code" href="classRunDB_1_1campaigninfo.html#f94bdc5c47921e3081af1d50cd4f5474">00423</a> <span class="keywordtype">void</span> <a class="code" href="classRunDB_1_1campaigninfo.html#f94bdc5c47921e3081af1d50cd4f5474">RunDB::campaigninfo::Init</a>()
<a name="l00424"></a>00424 {
<a name="l00425"></a>00425     <a class="code" href="classRunDB_1_1campaigninfo.html#32d9e17f8b6ed557c448cb63a643ec1c">campaign_id</a> = 0;
<a name="l00426"></a>00426     <a class="code" href="classRunDB_1_1campaigninfo.html#fcf0b7111b0a0e4fa019388e0b2151a7">version_id</a> = 0;
<a name="l00427"></a>00427     <a class="code" href="classRunDB_1_1campaigninfo.html#e9bea68fb66903a2ac49a81307e59255">pmts</a>.clear();
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#1ddd8722278d16b3aa7a151e1f403b12">00430</a> <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#1ddd8722278d16b3aa7a151e1f403b12">RunDB::campaigninfo::pmtinfo::pmtinfo</a>()
<a name="l00431"></a>00431 {
<a name="l00432"></a>00432     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#b08272c3bfbcf6380be4f7e6b2c7e533">serial_id</a> = <span class="stringliteral">""</span>;
<a name="l00433"></a>00433     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#cbfeb1d1b9aabf4d53417fab42b789d4">photocathode_x</a> = 0;
<a name="l00434"></a>00434     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#7f8dcb1bbb471d1f08e07bb5712fe04a">photocathode_y</a> = 0;
<a name="l00435"></a>00435     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#6b51a8dd246f22fbdc53e75dc14635e7">photocathode_z</a> = 0;
<a name="l00436"></a>00436     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#14c2755c79ac4fdcd55ce78e08a4fbe4">photocathode_r</a> = 0;
<a name="l00437"></a>00437     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#f7c2ab3516390eb5aa06bafc50db8e64">photocathode_theta</a> = 0;
<a name="l00438"></a>00438     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#c18ce8821bffe0e5e09ab60832b1c925">photocathode_area</a> = 1;
<a name="l00439"></a>00439     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#ed7481653e3e690beff270cf7da659be">photocathode_exp_area</a> = 1;
<a name="l00440"></a>00440     <a class="code" href="classRunDB_1_1campaigninfo_1_1pmtinfo.html#ef6b1aee7229f0c934e11ab3f055dc75">qe</a> = 1;
<a name="l00441"></a>00441 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 25 13:42:35 2013 for daqman by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
